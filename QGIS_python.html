<!DOCTYPE html><html><head>
      <title>QGIS_python</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:////home/mmann1123/.vscode/extensions/shd101wyy.markdown-preview-enhanced-0.8.13/crossnote/dependencies/katex/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="introduction-to-python-in-qgis">Introduction to Python in QGIS </h1>
<p>Welcome to our tutorial on using Python with QGIS! QGIS is a powerful open-source geographic information system (GIS) that supports various GIS operations and spatial data management. One of the fantastic features of QGIS is its built-in Python console, which allows you to enhance your GIS projects with programming.</p>
<p>QGIS brings a Python API (see <a href="https://docs.qgis.org/latest/en/docs/pyqgis_developer_cookbook/">PyQGIS Developer Cookbook</a> for some code samples) to let the user interact with its objects (layers, features, or interface). QGIS also has a Python console.</p>
<h2 id="table-of-contents"><em>Table of contents</em> </h2>
<ol>
<li><a href="#modules">Python Modules</a></li>
<li><a href="#using_qgis">Using Python with QGIS</a></li>
<li><a href="#tutorial1">Tutorial 1: Working with Crop Types in QGIS Python</a></li>
<li><a href="#tutorial2">Tutorial 2: Counting Observations by Crop Type in QGIS</a></li>
</ol>
<hr>
<h2 id="accessing-the-python-console-in-qgis">Accessing the Python Console in QGIS </h2>
<p>To get started with Python in QGIS, you first need to access the Python console. Here’s how you can do it:</p>
<ol>
<li><strong>Open QGIS</strong>: Start by launching the QGIS application on your computer.</li>
<li><strong>Open the Python Console</strong>: Look for a button on the toolbar that resembles a Python logo or go to the menu bar and select <code>Plugins</code> -&gt; <code>Python Console</code>. This will open a small scripting window at the bottom or side of your QGIS workspace.</li>
</ol>
<p>The Python console in QGIS is split into two main parts:</p>
<ul>
<li><strong>The command line</strong>: This is where you can type single lines of Python code and execute them immediately.</li>
<li><strong>The editor</strong>: Here, you can write more complex scripts, save them, and run them as needed.</li>
</ul>
<p>This dual setup allows you to quickly test small pieces of code and develop more extensive scripts for automating tasks.</p>
<h2 id="qgis-python-console">QGIS Python Console </h2>
<p>The console is a Python interpreter that allows you to execute Python commands. Modules from QGIS (analysis, core, gui, server, processing, 3d) and Qt (QtCore, QtGui, QtNetwork, QtWidgets, QtXml) as well as Python's math, os, re, and sys modules are already imported and can be used directly.</p>
<p>The interactive console is composed of a toolbar, an input area, and an output area.<br>
<img src="https://github.com/qgis/QGIS-Documentation/blob/master/docs/user_manual/plugins/img/python_console.png?raw=true" alt="The Python Console"></p>
<h3 id="toolbar">Toolbar </h3>
<p>The toolbar proposes the following tools:</p>
<ul>
<li>
<p>Clear Console <img src="https://github.com/qgis/QGIS-Documentation/blob/master//static/common/iconClearConsole.png?raw=true" alt="clearConsole"> to wipe the output area;</p>
</li>
<li>
<p>Run Command <img src="https://github.com/qgis/QGIS-Documentation/blob/master//static/common/mActionStart.png?raw=true" alt="start"> available in the input area: same as pressing Enter;</p>
</li>
<li>
<p>Show Editor <img src="https://github.com/qgis/QGIS-Documentation/blob/master//static/common/iconShowEditorConsole.png?raw=true" alt="showEditorConsole">: toggles console editor visibility;</p>
</li>
<li>
<p>Options... <img src="https://github.com/qgis/QGIS-Documentation/blob/master//static/common/mActionOptions.png?raw=true" alt="options">: opens a dialog to configure console properties;</p>
</li>
<li>
<p>Help... <img src="https://github.com/qgis/QGIS-Documentation/blob/master//static/common/mActionHelpContents.png?raw=true" alt="helpContents"> provides a menu to access various documentation:</p>
<ul>
<li><a href="https://docs.qgis.org/latest/en/docs/user_manual/plugins/python_console.html">Python Console Help</a></li>
<li><a href="https://qgis.org/api/">PyQGIS API documentation</a></li>
<li><a href="https://docs.qgis.org/latest/en/docs/pyqgis_developer_cookbook/">PyQGIS Cookbook</a></li>
</ul>
</li>
</ul>
<p>Dock Code Editor <img src="https://github.com/qgis/QGIS-Documentation/blob/master//static/common/dock.png?raw=true" alt="dock"> to dock or undock the panel in QGIS interface.</p>
<h2 id="why-use-python-in-qgis">Why Use Python in QGIS? </h2>
<p>Using Python in QGIS allows you to automate repetitive tasks, manipulate spatial data in ways that are cumbersome or impossible with the GUI alone, and extend the functionality of QGIS through custom scripts and plugins.</p>
<p>Throughout this tutorial, we will explore simple Python commands and scripts that you can execute in the Python console to interact with QGIS and perform basic GIS operations. These activities are designed to be fun and engaging, providing you with a hands-on introduction to programming within a GIS environment.</p>
<p>Let’s get started with some basic commands to familiarize you with the Python console in QGIS!</p>
<hr>
<h2 id="introduction-to-python-modules-a-namemodulesa">Introduction to Python Modules <a name="modules" href=""></a> </h2>
<p>In Python, a module is a file containing Python code that defines functions, classes, or variables, which can be accessed and utilized in other Python scripts.</p>
<p>Python has a vast standard library of modules that you can use for various tasks, from mathematical operations to handling internet data. Additionally, third-party modules can be installed and used in your projects, greatly extending Python's capabilities.</p>
<h3 id="importing-modules-in-python">Importing Modules in Python </h3>
<p>To use a module in Python, you need to import it into your script using the <code>import</code> statement. Once a module is imported, you can call its functions or access its classes and variables using the dot notation.</p>
<p>For example, to import the Python <code>math</code> module, you would write:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-import">import</span> math
</code></pre><p>Now you can use functions within the <code>math</code> module:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code>result <span class="token operator">=</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>  <span class="token comment"># Computes the square root of 25</span>
<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre><p>Paste these lines into the Python console in QGIS to see the output and press <img src="https://github.com/qgis/QGIS-Documentation/blob/master//static/common/mActionStart.png?raw=true" alt="start"></p>
<h3 id="using-python-with-qgis-a-nameusing_qgisa">Using Python with QGIS <a name="using_qgis" href=""></a> </h3>
<p>QGIS extends Python’s capabilities by providing a specialized module called <code>qgis</code>. This module allows you to interact with the QGIS application, manipulating geographical data and automating tasks.</p>
<p>To start scripting with Python in QGIS, you'll first need to import the necessary modules provided by QGIS. These typically include:</p>
<ul>
<li><code>qgis.core</code>: Provides core functionality like managing and manipulating vector and raster layers.</li>
<li><code>qgis.utils</code>: Contains utility functions for interacting with the QGIS interface.</li>
<li><code>iface</code>: A special variable from the <code>qgis.utils</code> module representing the QGIS interface, allowing you to interact with the application itself, like opening and displaying layers.</li>
</ul>
<p>Here’s how to import these modules into your QGIS Python script:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-from">from</span> qgis<span class="token punctuation">.</span>core <span class="token keyword keyword-import">import</span> <span class="token operator">*</span>
<span class="token keyword keyword-import">import</span> qgis<span class="token punctuation">.</span>utils
</code></pre><p>With these imports, you’re now ready to use the QGIS Python API to enhance your GIS projects with automated scripts and customized functionality!</p>
<hr>
<h2 id="tutorial-1-working-with-crop-types-in-qgis-python-a-nametutorial1a">Tutorial 1: Working with Crop Types in QGIS Python <a name="tutorial1" href=""></a> </h2>
<p>In this part of our tutorial, we'll learn how to read a GeoJSON file that contains various crop types, subset the data for rice crops, and then write the results to a new file. We will also explore a variant where you'll learn to write the results to a Shapefile instead by reading the QGIS API documentation.</p>
<h3 id="step-1-reading-the-geojson-file">Step 1: Reading the GeoJSON File </h3>
<p>First, we need to load our GeoJSON file into QGIS. We'll use the <code>iface</code> object, which is a part of the QGIS Python API that represents the main interface of QGIS.</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-from">from</span> qgis<span class="token punctuation">.</span>core <span class="token keyword keyword-import">import</span> <span class="token operator">*</span>
<span class="token keyword keyword-import">import</span> qgis<span class="token punctuation">.</span>utils

<span class="token comment"># Path to the GeoJSON file</span>
file_path <span class="token operator">=</span> <span class="token string">'path_to_your_file/tz_labels.geojson'</span>

<span class="token comment"># Load the layer in </span>
rice_layer <span class="token operator">=</span> iface<span class="token punctuation">.</span>addVectorLayer<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span>   <span class="token comment"># path to the file</span>
                                 baseName<span class="token operator">=</span> <span class="token string">"Rice Crops"</span><span class="token punctuation">,</span>  <span class="token comment"># name of the layer in QGIS</span>
                                 providerKey<span class="token operator">=</span><span class="token string">"ogr"</span><span class="token punctuation">)</span> <span class="token comment"># how to read it</span>
<span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> rice_layer<span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Layer failed to load!"</span><span class="token punctuation">)</span>
<span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Layer loaded successfully!"</span><span class="token punctuation">)</span>
</code></pre><p>Paste these lines into the Python console in QGIS to see the output and press <img src="https://github.com/qgis/QGIS-Documentation/blob/master//static/common/mActionStart.png?raw=true" alt="start"></p>
<p>You should now see <code>Rice Crops</code> in your QGIS Layers Panel. This layer contains the crop types data from the GeoJSON file.</p>
<p><img src="images/rice_crops.png" alt="Crop "></p>
<p>From this point on we will be refering this layer by the name <code>rice_layer</code> in our code.</p>
<br>
<blockquote>
<p><em>Where do I find the path to my file?</em></p>
</blockquote>
<p>In order to load a file into python you will need to find the 'path' to the <code>tz_labels.geojson</code> file.  Start by <code>Layer</code> &gt; <code>Add Layer</code> &gt; <code>Add Vector Layer</code>. Then in your layers list <code>right-click</code> on <code>tz_labels</code> and select <code>Properties</code>.  In the <code>General</code> tab you will find the <code>Layer Source</code> which is the path to your file.  Copy and paste this path into the <code>file_path</code> variable in the code above.</p>
<p><img src="https://github.com/mmann1123/YM_Conference_Thailand/blob/main/images/layer_path.png?raw=true" alt="Layer Properties"><br>
<em>Make sure your path doesn't include <code>'file://'</code> at the beginning.</em></p>
<h3 id="step-2-subsetting-the-data-for-maize-crops">Step 2: Subsetting the Data for Maize Crops </h3>
<p>Next, we'll filter out the rice crops from our dataset. We'll assume that the crop types are stored in a field named <code>crop_type</code>.</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Select features where the crop type is 'Rice'</span>
rice_layer<span class="token punctuation">.</span>selectByExpression<span class="token punctuation">(</span><span class="token string">"\"primary_crop\" = 'maize'"</span><span class="token punctuation">)</span>
<span class="token comment"># Print the number of selected rows</span>
<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Number of selected rows: </span><span class="token interpolation"><span class="token punctuation">{</span>rice_layer<span class="token punctuation">.</span>selectedFeatureCount<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre><p>Paste these lines into the Python console in QGIS to see the output and press <img src="https://github.com/qgis/QGIS-Documentation/blob/master//static/common/mActionStart.png?raw=true" alt="start"></p>
<blockquote>
<p><strong>Note:</strong><br>
For more on how to create expressions in Qgis see <a href="https://mmann1123.github.io/YM_Conference_Thailand/select_expressions.html">Select Expressions</a></p>
</blockquote>
<h3 id="step-3-writing-the-subset-to-a-new-geojson-file">Step 3: Writing the Subset to a New GeoJSON File </h3>
<p>After subsetting the data, let's write the selected features to a new GeoJSON file.</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Define the output file path</span>
output_path <span class="token operator">=</span> <span class="token string">'path_to_output/rice_subset.geojson'</span>

<span class="token comment"># Write the selected features to a new GeoJSON</span>
error <span class="token operator">=</span> QgsVectorFileWriter<span class="token punctuation">.</span>writeAsVectorFormat<span class="token punctuation">(</span>layer <span class="token operator">=</span> rice_layer<span class="token punctuation">,</span> 
                    fileName <span class="token operator">=</span> output_path<span class="token punctuation">,</span> <span class="token comment"># path and name of the output file</span>
                    fileEncoding <span class="token operator">=</span> <span class="token string">"UTF-8"</span><span class="token punctuation">,</span> <span class="token comment"># encoding of the output file</span>
                    destCRS <span class="token operator">=</span> rice_layer<span class="token punctuation">.</span>crs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># projection of the output file</span>
                    driverName <span class="token operator">=</span><span class="token string">"GeoJSON"</span><span class="token punctuation">,</span> <span class="token comment"># output file format</span>
                    onlySelected<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># write only selected features</span>

<span class="token keyword keyword-if">if</span> error<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> QgsVectorFileWriter<span class="token punctuation">.</span>NoError<span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Success: GeoJSON file has been created."</span><span class="token punctuation">)</span>
<span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Error: Failed to write GeoJSON."</span><span class="token punctuation">)</span>
</code></pre><p>Your <code>output_path</code> should be a new file in the same directory as the original file. You can now load this new file into QGIS to see the subset of rice crops.</p>
<hr>
<h4 id="full-script">Full Script </h4>
<p>The following is the full script that you can run in the QGIS Python console to read a GeoJSON file, subset the data for rice crops, and write the results to a new file.</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-from">from</span> qgis<span class="token punctuation">.</span>core <span class="token keyword keyword-import">import</span> <span class="token operator">*</span>
<span class="token keyword keyword-import">import</span> qgis<span class="token punctuation">.</span>utils

<span class="token comment"># Path to the GeoJSON file</span>
file_path <span class="token operator">=</span> <span class="token string">'path_to_your_file/tz_labels.geojson'</span>

<span class="token comment"># Load the layer in</span>
rice_layer <span class="token operator">=</span> iface<span class="token punctuation">.</span>addVectorLayer<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span>   <span class="token comment"># path to the file</span>
                                 baseName<span class="token operator">=</span> <span class="token string">"Rice Crops"</span><span class="token punctuation">,</span>  <span class="token comment"># name of the layer in QGIS</span>
                                 providerKey<span class="token operator">=</span><span class="token string">"ogr"</span><span class="token punctuation">)</span> <span class="token comment"># how to read it</span>
<span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> rice_layer<span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Layer failed to load!"</span><span class="token punctuation">)</span>
<span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Layer loaded successfully!"</span><span class="token punctuation">)</span>

<span class="token comment"># Select features where the crop type is 'Rice'</span>
rice_layer<span class="token punctuation">.</span>selectByExpression<span class="token punctuation">(</span><span class="token string">"\"primary_crop\" = 'maize'"</span><span class="token punctuation">)</span>
<span class="token comment"># Print the number of selected rows</span>
<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Number of selected rows: </span><span class="token interpolation"><span class="token punctuation">{</span>rice_layer<span class="token punctuation">.</span>selectedFeatureCount<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>


<span class="token comment"># Define the output file path</span>
output_path <span class="token operator">=</span> <span class="token string">'path_to_output/rice_subset.geojson'</span>

<span class="token comment"># Write the selected features to a new GeoJSON</span>
error <span class="token operator">=</span> QgsVectorFileWriter<span class="token punctuation">.</span>writeAsVectorFormat<span class="token punctuation">(</span>layer <span class="token operator">=</span> rice_layer<span class="token punctuation">,</span> 
                    fileName <span class="token operator">=</span> output_path<span class="token punctuation">,</span> <span class="token comment"># path and name of the output file</span>
                    fileEncoding <span class="token operator">=</span> <span class="token string">"UTF-8"</span><span class="token punctuation">,</span> <span class="token comment"># encoding of the output file</span>
                    destCRS <span class="token operator">=</span> rice_layer<span class="token punctuation">.</span>crs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># projection of the output file</span>
                    driverName <span class="token operator">=</span><span class="token string">"GeoJSON"</span><span class="token punctuation">,</span> <span class="token comment"># output file format</span>
                    onlySelected<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># write only selected features</span>

<span class="token keyword keyword-if">if</span> error<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> QgsVectorFileWriter<span class="token punctuation">.</span>NoError<span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Success: GeoJSON file has been created."</span><span class="token punctuation">)</span>
<span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Error: Failed to write GeoJSON."</span><span class="token punctuation">)</span>
</code></pre><hr>
<h4 id="challenge-a-import-your-file">Challenge A: Import your file </h4>
<p>Now that you've created a new GeoJSON file with the subset of rice crops, try loading it into QGIS and exploring the data using <code>output_path</code> and <code>iface.addVectorLayer()</code></p>
<h4 id="challenge-b-writing-to-a-shapefile">Challenge B: Writing to a Shapefile </h4>
<p>If you want to write the output to a Shapefile instead, you'll need to consult the QGIS API documentation to learn about the parameters required for writing a Shapefile. Here's how you might start:</p>
<ol>
<li>Open the QGIS Python API documentation: <a href="https://docs.qgis.org/3.34/en/docs/pyqgis_developer_cookbook/vector.html#creating-vector-layers">QGIS Cook Book</a></li>
<li>Search for <code>QgsVectorFileWriter</code> and read about the different parameters you can use, especially how to specify the output format for a Shapefile.</li>
</ol>
<p>Here’s a hint on how you might adjust the code for writing a Shapefile:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Define the output file path for the Shapefile</span>
output_path_shp <span class="token operator">=</span> <span class="token string">'path_to_output/rice_subset.shp'</span>

error <span class="token operator">=</span> QgsVectorFileWriter<span class="token punctuation">.</span>writeAsVectorFormat<span class="token punctuation">(</span>layer <span class="token operator">=</span> rice_layer<span class="token punctuation">,</span> 
                    fileName <span class="token operator">=</span> output_path_shp<span class="token punctuation">,</span> <span class="token comment"># path and name of the output file</span>
                    fileEncoding <span class="token operator">=</span> <span class="token string">"UTF-8"</span><span class="token punctuation">,</span> <span class="token comment"># encoding of the output file</span>
                    destCRS <span class="token operator">=</span> rice_layer<span class="token punctuation">.</span>crs<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># projection of the output file</span>
                    driverName <span class="token operator">=</span> __________________<span class="token punctuation">,</span> <span class="token comment"># output file format</span>
                    onlySelected<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># write only selected features</span>

<span class="token keyword keyword-if">if</span> error_shp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> QgsVectorFileWriter<span class="token punctuation">.</span>NoError<span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Success: Shapefile has been created."</span><span class="token punctuation">)</span>
<span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Error: Failed to write Shapefile."</span><span class="token punctuation">)</span>

</code></pre><h3 id="summary-tutorial-1">Summary Tutorial 1 </h3>
<p>In this tutorial, we learned how to use Python in QGIS to read a GeoJSON file, subset the data for rice crops, and write the results to a new file. We also explored how to write the output to a Shapefile by consulting the QGIS API documentation.</p>
<hr>
<hr>
<h2 id="tutorial-2-counting-observations-by-crop-type-in-qgis-a-nametutorial2a">Tutorial 2: Counting Observations by Crop Type in QGIS <a name="tutorial2" href=""></a> </h2>
<p>In this tutorial, we will learn how to load a vector layer into QGIS, access its attribute data, and perform a basic analysis by counting the number of observations for each crop type using the <code>primary_crop</code> field from the <code>tz_labels.geojson</code> dataset.</p>
<h3 id="step-1-load-the-vector-layer">Step 1: Load the Vector Layer </h3>
<p>First, let’s load the <code>tz_labels.geojson</code> into QGIS. Open the Python console in QGIS and use the following command to add the layer:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Load the tz_labels.geojson file</span>
layer_path <span class="token operator">=</span> <span class="token string">"/path/to/tz_labels.geojson"</span>  <span class="token comment"># Update this path to your file's location</span>
tz_labels_layer <span class="token operator">=</span> iface<span class="token punctuation">.</span>addVectorLayer<span class="token punctuation">(</span>layer_path<span class="token punctuation">,</span> <span class="token string">"TZ Labels"</span><span class="token punctuation">,</span> <span class="token string">"ogr"</span><span class="token punctuation">)</span>
<span class="token keyword keyword-if">if</span> <span class="token keyword keyword-not">not</span> tz_labels_layer<span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Failed to load the layer."</span><span class="token punctuation">)</span>
<span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string">"Layer loaded successfully."</span><span class="token punctuation">)</span>
</code></pre><h3 id="using-dictionaries-to-count-items-in-python">Using Dictionaries to Count Items in Python </h3>
<p>In Python, a dictionary is a collection of key-value pairs where each key is unique. This structure is ideal for counting occurrences of items because you can use the item as the key and its count as the value.</p>
<h4 id="basic-example-of-counting-with-dictionaries">Basic Example of Counting with Dictionaries </h4>
<p>Let’s look at a simple example using a list of fruits to illustrate how we can use a dictionary to count occurrences.</p>
<ol>
<li><em>List of Fruits</em>: We start with a list of fruits where some fruits may appear multiple times.</li>
</ol>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># List of fruits</span>
fruits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'banana'</span><span class="token punctuation">,</span> <span class="token string">'orange'</span><span class="token punctuation">,</span> <span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'orange'</span><span class="token punctuation">,</span> <span class="token string">'banana'</span><span class="token punctuation">,</span> <span class="token string">'orange'</span><span class="token punctuation">]</span>
</code></pre><ol start="2">
<li><em>Initialize the Dictionary</em>: We start with an empty dictionary <code>fruit_counts</code> where each fruit name will be a key, and the count of that fruit will be the corresponding value.</li>
</ol>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Initialize a dictionary to hold the count of each fruit</span>
fruit_counts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><ol start="3">
<li><em>Iterate Through the List</em>: We loop through each element in the <code>fruits</code> list.</li>
<li><em>Update the Dictionary</em>: As we move through the elements of <code>fruits</code> list, we update the <code>fruit_counts</code> dictionary:
<ul>
<li>If the fruit is already a key in the dictionary (<code>if fruit in fruit_counts</code>), we increase its count by 1.</li>
<li>If the fruit is not yet a new <code>fruit</code> key in the dictionary, we add it and set its count to 1.</li>
</ul>
</li>
</ol>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Iterate over the list of fruits</span>
<span class="token keyword keyword-for">for</span> fruit <span class="token keyword keyword-in">in</span> fruits<span class="token punctuation">:</span>
    <span class="token keyword keyword-if">if</span> fruit <span class="token keyword keyword-in">in</span> fruit_counts<span class="token punctuation">:</span>
        fruit_counts<span class="token punctuation">[</span>fruit<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token comment"># Increment the count if the fruit is already in the dictionary</span>
    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
        fruit_counts<span class="token punctuation">[</span>fruit<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># Set the count to 1 if the fruit is not in the dictionary yet</span>
</code></pre><ol start="5">
<li><em>Print the Results</em>: After the loop, we print each fruit and its count. The <code>items()</code> method returns a list of tuple pairs (key, value) from the dictionary.</li>
</ol>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Print the counts for each fruit</span>
<span class="token keyword keyword-for">for</span> fruit<span class="token punctuation">,</span> count <span class="token keyword keyword-in">in</span> fruit_counts<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>fruit<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre><p><strong>Output</strong>:<br>
The following is the output of the code snippet above:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code>apple<span class="token punctuation">:</span> <span class="token number">2</span>
banana<span class="token punctuation">:</span> <span class="token number">2</span>
orange<span class="token punctuation">:</span> <span class="token number">3</span>
</code></pre><h3 id="step-2-applying-this-to-qgis-data">Step 2: Applying This to QGIS Data </h3>
<p>We can apply the same technique to count crop types from a feature layer in QGIS. Here’s how it connects to our GIS data example:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token comment"># Suppose we have a layer loaded as tz_labels_layer and it contains a field 'primary_crop'</span>

<span class="token comment"># Initialize a dictionary to hold the count of each crop type</span>
crop_counts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment"># Access the features (rows) in the layer</span>
<span class="token keyword keyword-for">for</span> feature <span class="token keyword keyword-in">in</span> tz_labels_layer<span class="token punctuation">.</span>getFeatures<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Get the value of the 'primary_crop' field</span>
    crop_type <span class="token operator">=</span> feature<span class="token punctuation">[</span><span class="token string">'primary_crop'</span><span class="token punctuation">]</span>
    
    <span class="token comment"># Use the dictionary counting method</span>
    <span class="token keyword keyword-if">if</span> crop_type <span class="token keyword keyword-in">in</span> crop_counts<span class="token punctuation">:</span>
        crop_counts<span class="token punctuation">[</span>crop_type<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
        crop_counts<span class="token punctuation">[</span>crop_type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># Print the counts for each crop type</span>
<span class="token keyword keyword-for">for</span> crop<span class="token punctuation">,</span> count <span class="token keyword keyword-in">in</span> crop_counts<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-print">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>crop<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>count<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre><p>Your output should be as follows:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>maize: <span class="token number">403</span>
rice: <span class="token number">280</span>
soybeans: <span class="token number">10</span>
sunflower: <span class="token number">278</span>
peanuts: <span class="token number">13</span>
fallow_barren: <span class="token number">1</span>
cassava: <span class="token number">76</span>
sorghum: <span class="token number">131</span>
okra: <span class="token number">2</span>
millet: <span class="token number">139</span>
no: <span class="token number">5</span>
cotton: <span class="token number">50</span>
don_t_know: <span class="token number">2</span>
large_building: <span class="token number">1</span>
forest_shrubland: <span class="token number">2</span>
could be maize.: <span class="token number">1</span>
water_body: <span class="token number">1</span>
water: <span class="token number">5</span>
</code></pre><p>This method efficiently tracks the number of occurrences of each crop type, providing a quick summary of the data in your GIS layer. By leveraging Python dictionaries, you can easily extend this approach to count various attributes across different datasets in QGIS.</p>
<hr>
<h4 id="challenge-c-count-observations-by-field-size">Challenge C: Count observations by field size </h4>
<p>Our <code>tz_labels.geojson</code> dataset contains a field named <code>field_size</code> that represents the size of each field. Try adapting the code to count the number of observations for each field size category.</p>
<h3 id="summary-tutorial-2">Summary Tutorial 2 </h3>
<p>This tutorial demonstrates a simple way to perform attribute data analysis directly within QGIS using Python. By counting the occurrences of different crop types, we can quickly assess the composition of agricultural data in the provided <code>tz_labels.geojson</code>. This process can be adapted to other datasets and attributes for various analytical needs.</p>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>